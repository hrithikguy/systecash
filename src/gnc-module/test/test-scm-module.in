#! @SHELL@
${GUILE} -c "(use-modules (systecash unittest-support))
          (define log-domain \"gnc.module\")
          (define check (new-TestErrorStruct))
          (define log-level (G-LOG-LEVEL-WARNING))
          (define msg \"Module '../../../src/gnc-module/test/misc-mods/.libs/libgncmod_futuremodsys.so' requires newer module system\n\")
          (TestErrorStruct-log-domain-set check log-domain)
          (TestErrorStruct-log-level-set check log-level)
          (TestErrorStruct-msg-set check msg)
          (define handler (test-set-checked-handler log-domain log-level check))
          (use-modules (systecash gnc-module))
          (gnc:module-system-init)
          (if (not (gnc:module-load \"systecash/foo\" 0)) (exit -1))
          (exit (foo:scheme-hello))
          (g-log-remove-handler log-domain handler)"
